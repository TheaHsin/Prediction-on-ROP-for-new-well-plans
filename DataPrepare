import pandas as pd
import numpy as np
from sklearn.preprocessing import StandardScaler

df = pd.read_csv('training.csv')
y = df['rate_of_penetration']
X = df.drop(['segment_id','rate_of_penetration','max_depth'],axis=1)
X.index = range(X.shape[0])
X_std = pd.DataFrame(StandardScaler().fit_transform(X.iloc[:,5:]))
X = pd.concat([X.iloc[:,:5], X_std], axis=1)
X = pd.get_dummies(X)



from sklearn.linear_model import LinearRegression as LR
from sklearn.model_selection import train_test_split
from sklearn.decomposition import PCA

X_dr = pd.DataFrame(PCA(35).fit_transform(X))
xtrain, xtest, ytrain, ytest = train_test_split(X_dr, y, test_size=0.25, random_state=17)
xtrain.index = range(xtrain.shape[0])
xtest.index = range(xtest.shape[0])
reg = LR().fit(xtrain, ytrain)
yhat = reg.predict(xtest)

from sklearn.metrics import mean_squared_error as MSE
MSE(yhat, ytest)**0.5
